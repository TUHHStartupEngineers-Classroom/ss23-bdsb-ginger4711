{
  "hash": "a33ddd0a4567099f0304766f72756e9b",
  "result": {
    "markdown": "---\ntitle: \"Tidyverse\"\nauthor: \"Christian Sühl\"\n---\n\n\n# Intro reading\n| This is the first chapter of my lab journal focusing on the *Tidyverse*.\n| At first i started to read the chapter *Intro to the Tidyverse* and used the `INSTALL_PKGS.R` file to install all the required packages.\n| After reading through the basics like *Pipes*, *Tibbles* and *Import*.\n\n\n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-2_fcf6625521baccf63183a0ee62cfce87'}\n\n```{.r .cell-code}\ntibble(\n    x = 1:50,\n    y = runif(50), \n    z = x + y^2,\n    outcome = rnorm(50)\n  )\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"x\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"y\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"z\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"outcome\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"0.581867740\",\"3\":\"1.338570\",\"4\":\"0.006394022\"},{\"1\":\"2\",\"2\":\"0.689033649\",\"3\":\"2.474767\",\"4\":\"1.480380862\"},{\"1\":\"3\",\"2\":\"0.838718151\",\"3\":\"3.703448\",\"4\":\"-0.373514210\"},{\"1\":\"4\",\"2\":\"0.635994180\",\"3\":\"4.404489\",\"4\":\"-1.301917807\"},{\"1\":\"5\",\"2\":\"0.789752700\",\"3\":\"5.623709\",\"4\":\"-1.248030787\"},{\"1\":\"6\",\"2\":\"0.585919696\",\"3\":\"6.343302\",\"4\":\"-0.135028004\"},{\"1\":\"7\",\"2\":\"0.410729198\",\"3\":\"7.168698\",\"4\":\"-2.495085172\"},{\"1\":\"8\",\"2\":\"0.326278342\",\"3\":\"8.106458\",\"4\":\"-0.707134403\"},{\"1\":\"9\",\"2\":\"0.008385042\",\"3\":\"9.000070\",\"4\":\"-0.699819635\"},{\"1\":\"10\",\"2\":\"0.173512412\",\"3\":\"10.030107\",\"4\":\"-0.446601814\"},{\"1\":\"11\",\"2\":\"0.264603462\",\"3\":\"11.070015\",\"4\":\"-1.469779238\"},{\"1\":\"12\",\"2\":\"0.921197871\",\"3\":\"12.848606\",\"4\":\"0.844086470\"},{\"1\":\"13\",\"2\":\"0.441197668\",\"3\":\"13.194655\",\"4\":\"-0.196310911\"},{\"1\":\"14\",\"2\":\"0.019976418\",\"3\":\"14.000399\",\"4\":\"0.220527977\"},{\"1\":\"15\",\"2\":\"0.502456981\",\"3\":\"15.252463\",\"4\":\"1.160251916\"},{\"1\":\"16\",\"2\":\"0.522329208\",\"3\":\"16.272828\",\"4\":\"0.879851170\"},{\"1\":\"17\",\"2\":\"0.869912869\",\"3\":\"17.756748\",\"4\":\"-0.197702897\"},{\"1\":\"18\",\"2\":\"0.352837565\",\"3\":\"18.124494\",\"4\":\"-0.342032734\"},{\"1\":\"19\",\"2\":\"0.367014344\",\"3\":\"19.134700\",\"4\":\"0.834418272\"},{\"1\":\"20\",\"2\":\"0.840063011\",\"3\":\"20.705706\",\"4\":\"0.429138079\"},{\"1\":\"21\",\"2\":\"0.386539142\",\"3\":\"21.149413\",\"4\":\"2.453274454\"},{\"1\":\"22\",\"2\":\"0.166596629\",\"3\":\"22.027754\",\"4\":\"1.355634820\"},{\"1\":\"23\",\"2\":\"0.031308447\",\"3\":\"23.000980\",\"4\":\"1.008105605\"},{\"1\":\"24\",\"2\":\"0.455585439\",\"3\":\"24.207558\",\"4\":\"-0.228353274\"},{\"1\":\"25\",\"2\":\"0.922975688\",\"3\":\"25.851884\",\"4\":\"-1.062328707\"},{\"1\":\"26\",\"2\":\"0.463090385\",\"3\":\"26.214453\",\"4\":\"0.670560142\"},{\"1\":\"27\",\"2\":\"0.984034267\",\"3\":\"27.968323\",\"4\":\"0.414949875\"},{\"1\":\"28\",\"2\":\"0.836715826\",\"3\":\"28.700093\",\"4\":\"-1.977837271\"},{\"1\":\"29\",\"2\":\"0.830912866\",\"3\":\"29.690416\",\"4\":\"-0.865910492\"},{\"1\":\"30\",\"2\":\"0.089369709\",\"3\":\"30.007987\",\"4\":\"1.155088480\"},{\"1\":\"31\",\"2\":\"0.166060724\",\"3\":\"31.027576\",\"4\":\"0.739217616\"},{\"1\":\"32\",\"2\":\"0.842350907\",\"3\":\"32.709555\",\"4\":\"-0.730563717\"},{\"1\":\"33\",\"2\":\"0.670688031\",\"3\":\"33.449822\",\"4\":\"-1.291147437\"},{\"1\":\"34\",\"2\":\"0.953258124\",\"3\":\"34.908701\",\"4\":\"0.175644997\"},{\"1\":\"35\",\"2\":\"0.197101039\",\"3\":\"35.038849\",\"4\":\"-1.143205983\"},{\"1\":\"36\",\"2\":\"0.133395453\",\"3\":\"36.017794\",\"4\":\"1.247689483\"},{\"1\":\"37\",\"2\":\"0.359887813\",\"3\":\"37.129519\",\"4\":\"-1.162317459\"},{\"1\":\"38\",\"2\":\"0.503604545\",\"3\":\"38.253618\",\"4\":\"2.141087120\"},{\"1\":\"39\",\"2\":\"0.114915362\",\"3\":\"39.013206\",\"4\":\"-0.662192192\"},{\"1\":\"40\",\"2\":\"0.499233359\",\"3\":\"40.249234\",\"4\":\"1.572570912\"},{\"1\":\"41\",\"2\":\"0.934965965\",\"3\":\"41.874161\",\"4\":\"1.862046144\"},{\"1\":\"42\",\"2\":\"0.342855869\",\"3\":\"42.117550\",\"4\":\"0.756037730\"},{\"1\":\"43\",\"2\":\"0.667057222\",\"3\":\"43.444965\",\"4\":\"-0.726570780\"},{\"1\":\"44\",\"2\":\"0.883002246\",\"3\":\"44.779693\",\"4\":\"-0.048931796\"},{\"1\":\"45\",\"2\":\"0.833820759\",\"3\":\"45.695257\",\"4\":\"-1.014923889\"},{\"1\":\"46\",\"2\":\"0.790447893\",\"3\":\"46.624808\",\"4\":\"1.693981697\"},{\"1\":\"47\",\"2\":\"0.489639736\",\"3\":\"47.239747\",\"4\":\"-0.125986563\"},{\"1\":\"48\",\"2\":\"0.391914833\",\"3\":\"48.153597\",\"4\":\"0.214351740\"},{\"1\":\"49\",\"2\":\"0.787023596\",\"3\":\"49.619406\",\"4\":\"0.417793990\"},{\"1\":\"50\",\"2\":\"0.900411717\",\"3\":\"50.810741\",\"4\":\"0.718809265\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-3_232a877aad6dff52cdef16256629585c'}\n\n```{.r .cell-code}\nlibrary(readr)\ndataset_tbl <- read_csv(\"../../src/test-data.csv\",show_col_types = FALSE)\nreadr::problems(dataset_tbl)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"row\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"col\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"expected\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"actual\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"file\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n# Tidy Exercise\n1. Table 1 is tidy\n2. Table 2 is not tidy, since the name of the variable is stored in every row of the table and not just as a column name with the values in that column.\n3. Table 3 is untidy, since here the variable names are addressing individual rows whereas they should do that with columns. So the table would need to be rotated.\n4. Table 4 is untidy, since multiple variables are stored per column.\n\n# Diamonds\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-4_78733054429cd800a0a9e55a46d65b37'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\ndiamonds2 <- readRDS(\"../../src/diamonds2.rds\")\ndiamonds2\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"cut\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"2008\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2009\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Ideal\",\"2\":\"326\",\"3\":\"332\"},{\"1\":\"Premium\",\"2\":\"326\",\"3\":\"332\"},{\"1\":\"Good\",\"2\":\"237\",\"3\":\"333\"},{\"1\":\"Premium\",\"2\":\"334\",\"3\":\"340\"},{\"1\":\"Good\",\"2\":\"335\",\"3\":\"341\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ndiamonds2_long <- diamonds2 %>% \n  pivot_longer(cols      = c(\"2008\", \"2009\"), \n               names_to  = 'year', \n               values_to = 'price') %>% \n  head(n = 5)\ndiamonds2_long\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"cut\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"year\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"price\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Ideal\",\"2\":\"2008\",\"3\":\"326\"},{\"1\":\"Ideal\",\"2\":\"2009\",\"3\":\"332\"},{\"1\":\"Premium\",\"2\":\"2008\",\"3\":\"326\"},{\"1\":\"Premium\",\"2\":\"2009\",\"3\":\"332\"},{\"1\":\"Good\",\"2\":\"2008\",\"3\":\"237\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nlm(price ~ ., data = diamonds2_long)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = price ~ ., data = diamonds2_long)\n#> \n#> Coefficients:\n#> (Intercept)     cutIdeal   cutPremium     year2009  \n#>         237           89           89            6\n```\n:::\n\n```{.r .cell-code}\ndiamonds3 <- readRDS(\"../../src/diamonds3.rds\")\ndiamonds3 %>% pivot_wider(names_from = \"dimension\",values_from = \"measurement\") %>% head(n=5)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"cut\"],\"name\":[1],\"type\":[\"ord\"],\"align\":[\"right\"]},{\"label\":[\"price\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"clarity\"],\"name\":[3],\"type\":[\"ord\"],\"align\":[\"right\"]},{\"label\":[\"x\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"z\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Ideal\",\"2\":\"326\",\"3\":\"SI2\",\"4\":\"3.95\",\"5\":\"3.98\",\"6\":\"2.43\"},{\"1\":\"Premium\",\"2\":\"326\",\"3\":\"SI1\",\"4\":\"3.89\",\"5\":\"3.84\",\"6\":\"2.31\"},{\"1\":\"Good\",\"2\":\"327\",\"3\":\"VS1\",\"4\":\"4.05\",\"5\":\"4.07\",\"6\":\"2.31\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ndiamonds4 <- readRDS(\"../../src/diamonds4.rds\")\ndiamonds4 %>% separate(col = dim, into = c(\"x\",\"y\",\"z\"),sep = \"/\", convert = T)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"cut\"],\"name\":[1],\"type\":[\"ord\"],\"align\":[\"right\"]},{\"label\":[\"price\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"clarity\"],\"name\":[3],\"type\":[\"ord\"],\"align\":[\"right\"]},{\"label\":[\"x\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"z\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Ideal\",\"2\":\"326\",\"3\":\"SI2\",\"4\":\"3.95\",\"5\":\"3.98\",\"6\":\"2.43\"},{\"1\":\"Premium\",\"2\":\"326\",\"3\":\"SI1\",\"4\":\"3.89\",\"5\":\"3.84\",\"6\":\"2.31\"},{\"1\":\"Good\",\"2\":\"327\",\"3\":\"VS1\",\"4\":\"4.05\",\"5\":\"4.07\",\"6\":\"2.31\"},{\"1\":\"Premium\",\"2\":\"334\",\"3\":\"VS2\",\"4\":\"4.20\",\"5\":\"4.23\",\"6\":\"2.63\"},{\"1\":\"Good\",\"2\":\"335\",\"3\":\"SI2\",\"4\":\"4.34\",\"5\":\"4.35\",\"6\":\"2.75\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ndiamonds5 <- readRDS(\"../../src/diamonds5.rds\")\ndiamonds5 %>% unite(clarity,clarity_prefix,clarity_suffix,sep='')\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"cut\"],\"name\":[1],\"type\":[\"ord\"],\"align\":[\"right\"]},{\"label\":[\"price\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"clarity\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"x\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"z\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Ideal\",\"2\":\"326\",\"3\":\"SI2\",\"4\":\"3.95\",\"5\":\"3.98\",\"6\":\"2.43\"},{\"1\":\"Premium\",\"2\":\"326\",\"3\":\"SI1\",\"4\":\"3.89\",\"5\":\"3.84\",\"6\":\"2.31\"},{\"1\":\"Good\",\"2\":\"327\",\"3\":\"VS1\",\"4\":\"4.05\",\"5\":\"4.07\",\"6\":\"2.31\"},{\"1\":\"Premium\",\"2\":\"334\",\"3\":\"VS2\",\"4\":\"4.20\",\"5\":\"4.23\",\"6\":\"2.63\"},{\"1\":\"Good\",\"2\":\"335\",\"3\":\"SI2\",\"4\":\"4.34\",\"5\":\"4.35\",\"6\":\"2.75\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n# Transform\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-5_67e14a41bd91a9d9307bb20ae6ee09e7'}\n\n```{.r .cell-code}\nlibrary(ggplot2) # To load the diamonds dataset\nlibrary(dplyr)\ndiamonds %>% \n    filter(cut == 'Premium', carat >= 0.3) %>% \n    head(5)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"carat\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"cut\"],\"name\":[2],\"type\":[\"ord\"],\"align\":[\"right\"]},{\"label\":[\"color\"],\"name\":[3],\"type\":[\"ord\"],\"align\":[\"right\"]},{\"label\":[\"clarity\"],\"name\":[4],\"type\":[\"ord\"],\"align\":[\"right\"]},{\"label\":[\"depth\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"table\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"price\"],\"name\":[7],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"x\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"z\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0.32\",\"2\":\"Premium\",\"3\":\"E\",\"4\":\"I1\",\"5\":\"60.9\",\"6\":\"58\",\"7\":\"345\",\"8\":\"4.38\",\"9\":\"4.42\",\"10\":\"2.68\"},{\"1\":\"0.30\",\"2\":\"Premium\",\"3\":\"J\",\"4\":\"SI2\",\"5\":\"59.3\",\"6\":\"61\",\"7\":\"405\",\"8\":\"4.43\",\"9\":\"4.38\",\"10\":\"2.61\"},{\"1\":\"0.30\",\"2\":\"Premium\",\"3\":\"D\",\"4\":\"SI1\",\"5\":\"62.6\",\"6\":\"59\",\"7\":\"552\",\"8\":\"4.23\",\"9\":\"4.27\",\"10\":\"2.66\"},{\"1\":\"0.42\",\"2\":\"Premium\",\"3\":\"I\",\"4\":\"SI2\",\"5\":\"61.5\",\"6\":\"59\",\"7\":\"552\",\"8\":\"4.78\",\"9\":\"4.84\",\"10\":\"2.96\"},{\"1\":\"0.31\",\"2\":\"Premium\",\"3\":\"G\",\"4\":\"SI1\",\"5\":\"61.8\",\"6\":\"58\",\"7\":\"553\",\"8\":\"4.35\",\"9\":\"4.32\",\"10\":\"2.68\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ndiamonds %>% \n  select(x:z, everything()) %>%\n  rename(colorcode = color) %>%\n  head(n = 5)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"x\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"z\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"carat\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"cut\"],\"name\":[5],\"type\":[\"ord\"],\"align\":[\"right\"]},{\"label\":[\"colorcode\"],\"name\":[6],\"type\":[\"ord\"],\"align\":[\"right\"]},{\"label\":[\"clarity\"],\"name\":[7],\"type\":[\"ord\"],\"align\":[\"right\"]},{\"label\":[\"depth\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"table\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"price\"],\"name\":[10],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"3.95\",\"2\":\"3.98\",\"3\":\"2.43\",\"4\":\"0.23\",\"5\":\"Ideal\",\"6\":\"E\",\"7\":\"SI2\",\"8\":\"61.5\",\"9\":\"55\",\"10\":\"326\"},{\"1\":\"3.89\",\"2\":\"3.84\",\"3\":\"2.31\",\"4\":\"0.21\",\"5\":\"Premium\",\"6\":\"E\",\"7\":\"SI1\",\"8\":\"59.8\",\"9\":\"61\",\"10\":\"326\"},{\"1\":\"4.05\",\"2\":\"4.07\",\"3\":\"2.31\",\"4\":\"0.23\",\"5\":\"Good\",\"6\":\"E\",\"7\":\"VS1\",\"8\":\"56.9\",\"9\":\"65\",\"10\":\"327\"},{\"1\":\"4.20\",\"2\":\"4.23\",\"3\":\"2.63\",\"4\":\"0.29\",\"5\":\"Premium\",\"6\":\"I\",\"7\":\"VS2\",\"8\":\"62.4\",\"9\":\"58\",\"10\":\"334\"},{\"1\":\"4.34\",\"2\":\"4.35\",\"3\":\"2.75\",\"4\":\"0.31\",\"5\":\"Good\",\"6\":\"J\",\"7\":\"SI2\",\"8\":\"63.3\",\"9\":\"58\",\"10\":\"335\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ndiamonds %>%\n  group_by(color) %>%\n  summarize(max_price  = max(price),\n            mean_price = mean(price),\n            min_price  = min(price))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"color\"],\"name\":[1],\"type\":[\"ord\"],\"align\":[\"right\"]},{\"label\":[\"max_price\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"mean_price\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"min_price\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"D\",\"2\":\"18693\",\"3\":\"3169.954\",\"4\":\"357\"},{\"1\":\"E\",\"2\":\"18731\",\"3\":\"3076.752\",\"4\":\"326\"},{\"1\":\"F\",\"2\":\"18791\",\"3\":\"3724.886\",\"4\":\"342\"},{\"1\":\"G\",\"2\":\"18818\",\"3\":\"3999.136\",\"4\":\"354\"},{\"1\":\"H\",\"2\":\"18803\",\"3\":\"4486.669\",\"4\":\"337\"},{\"1\":\"I\",\"2\":\"18823\",\"3\":\"5091.875\",\"4\":\"334\"},{\"1\":\"J\",\"2\":\"18710\",\"3\":\"5323.818\",\"4\":\"335\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nlibrary(lubridate)\nymd(19690716)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] \"1969-07-16\"\n```\n:::\n:::\n\n\n# Business case\nTried out all the examples. See SALES_ANALYSIS.R in the src directory for details.\n\n# Challenge\n| Worked pretty well adjusting the existing plots for year and category to location and year.\n| Code is also present in SALES_ANALYSIS.R file.\n\n\n\n\n::: {.cell hash='01_tidyverse_cache/html/plot_d1212a7bb51b78c9dad6ab5b230ae481'}\n\n```{.r .cell-code}\n# 6.3 Sales by location\n\n# Step 1 - Manipulate\nsales_by_location_tbl <- bike_orderlines_wrangled_tbl %>%\n  # Seperate city and state into two separate columns\n  separate(col = location,\n           into = c(\"city\",\"state\"),\n           sep = \", \",\n           convert = T) %>%\n  \n  # Select columns\n  select(state, total_price) %>%\n  \n  # Grouping by year and summarizing sales\n  group_by(state) %>% \n  summarize(sales = sum(total_price)) %>%\n  \n  # Optional: Add a column that turns the numbers into a currency format \n  # (makes it in the plot optically more appealing)\n  # mutate(sales_text = scales::dollar(sales)) <- Works for dollar values\n  mutate(sales_text = scales::dollar(sales, big.mark = \".\", \n                                     decimal.mark = \",\", \n                                     prefix = \"\", \n                                     suffix = \" €\"))\n \n# Step 2 - Visualize\nsales_by_location_tbl %>%\n  \n  # Setup canvas with the columns year (x-axis) and sales (y-axis)\n  ggplot(aes(x = state, y = sales)) +\n  \n  # Geometries\n  geom_col(fill = \"#2DC6D6\") + # Use geom_col for a bar plot\n  geom_label(aes(label = sales_text)) + # Adding labels to the bars\n  geom_smooth(method = \"lm\", se = FALSE) + # Adding a trendline\n  \n  # Formatting\n  # scale_y_continuous(labels = scales::dollar) + # Change the y-axis. \n  # Again, we have to adjust it for euro values\n  scale_y_continuous(labels = scales::dollar_format(big.mark = \".\", \n                                                    decimal.mark = \",\", \n                                                    prefix = \"\", \n                                                    suffix = \" €\")) +\n  labs(\n    title    = \"Revenue by location\",\n    subtitle = \"Upward Trend\",\n    x = \"\", # Override defaults for x and y\n    y = \"Revenue\"\n  ) +\n\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> `geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](01_tidyverse_files/figure-html/plot-1.png){width=1920}\n:::\n\n```{.r .cell-code}\n# 6.4 Sales by location and year\n# Step 1 - Manipulate\nsales_by_location_and_year_tbl <- bike_orderlines_wrangled_tbl %>%\n  # Seperate city and state into two separate columns\n  separate(col = location,\n           into = c(\"city\",\"state\"),\n           sep = \", \",\n           convert = T) %>%\n  \n  # Select columns and add a year\n  select(state, total_price, order_date) %>%\n  mutate(year = year(order_date)) %>%\n  \n  # Group by and summarize year and main catgegory\n  group_by(state, year) %>%\n  summarise(sales = sum(total_price)) %>%\n  ungroup() %>%\n  \n  # Format $ Text\n  mutate(sales_text = scales::dollar(sales, big.mark = \".\", \n                                     decimal.mark = \",\", \n                                     prefix = \"\", \n                                     suffix = \" €\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> `summarise()` has grouped output by 'state'. You can override using the\n#> `.groups` argument.\n```\n:::\n\n```{.r .cell-code}\n# Step 2 - Visualize\nsales_by_location_and_year_tbl %>%\n  \n  # Set up x, y, fill\n  ggplot(aes(x = year, y = sales, fill = year)) +\n  \n  # Geometries\n  geom_col() + # Run up to here to get a stacked bar plot\n  \n  # Facet\n  facet_wrap(~ state) +\n  \n  # Formatting\n  scale_y_continuous(labels = scales::dollar_format(big.mark = \".\", \n                                                    decimal.mark = \",\", \n                                                    prefix = \"\", \n                                                    suffix = \" €\")) +\n  labs(\n    title = \"Revenue by location and year\",\n    subtitle = \"Each year has an upward trend\",\n    fill = \"Year\" # Changes the legend name\n  ) +\n\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](01_tidyverse_files/figure-html/plot-2.png){width=1920}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}